<template>
  <div>
    <el-dialog title="非集客项目立项详情" :visible.sync="modalShow" width="80%" :before-close="modalClose">
    <el-row :gutter="15">
      <el-col :span="24" >
        <el-divider content-position="center" ><el-link type="primary"><b>非集客10w限额以下的审批流程</b></el-link></el-divider>
      </el-col>
	<el-form ref="form" :model="form"  label-width="80px">
	        <el-col :span="8">
	            <el-form-item label="项目名称" prop="proName">
	              <el-input v-model="form.proName" placeholder="请输入项目名称" />
	            </el-form-item>
	          </el-col>
	          <el-col :span="8">
	            <el-form-item label="所属公司" prop="belongCompanyname">
	              <el-input v-model="form.belongCompanyname" placeholder="请输入所属公司" />
	            </el-form-item>
	          </el-col>
	          <el-col :span="8">
	            <el-form-item label="所属部门" prop="belongDeptname">
	               <el-input v-model="form.belongDeptname" placeholder="请输入所属公司" />
	            </el-form-item>
	          </el-col>
	          <el-col :span="8">
	            <el-form-item label="项目类型" prop="proName">
	              <el-input v-model="form.proName" placeholder="请输入所属公司" />
	            </el-form-item>
	          </el-col>
	          <el-col :span="8">
	            <el-form-item label="项目分类" prop="classification">
	                <el-input v-model="form.classification" placeholder="请输入所属公司" />
	            </el-form-item>
	          </el-col>
	          <el-col :span="8">
	            <el-form-item label="合同金额" prop="contractAmountTotal">
	              <el-input
	                v-model="form.contractAmountTotal"
	                placeholder="请输入合同金额"
	                v-on:input="changeNum()"
	              />
	            </el-form-item>
	          </el-col>
	          <el-col :span="8">
	            <el-form-item label="税率(%)" prop="taxrate">
	              <el-input
	                v-model="form.taxrate"
	                placeholder="请输入税率"
	                v-on:input="changeNum()"
	              />
	            </el-form-item>
	          </el-col>
	          <el-col :span="8">
	            <el-form-item label="不含税金额" prop="contractAmountTax">
	              <el-input
	                v-model="form.contractAmountTax"
	                placeholder="不含税金额"

	                :disabled="true"
	              />
	            </el-form-item>
	          </el-col>
	          <el-col :span="8">
	            <el-form-item label="税额(元)" prop="taxamount" >
	              <el-input
	                v-model="form.taxamount"

	                placeholder="税额"
	                :disabled="true"
	              />
	            </el-form-item>
	          </el-col>
	          <el-col :span="24">
	            <el-form-item label="申请原因" prop="reqReason">
	              <el-input
	                v-model="form.reqReason"
	                type="textarea"
	                placeholder="请输入内容"
	              />
	            </el-form-item>
	          </el-col>
	          <el-col :span="24">
	            <el-form-item label="说明" prop="explainInfo">
	              <el-input
	                v-model="form.explainInfo"
	                type="textarea"
	                placeholder="请输入内容"
	              />
	            </el-form-item>
	          </el-col>
	        <!-- <el-form-item label="附件" prop="files">
	          <el-upload
	            ref="field101"
	            :file-list="field101fileList"
	            :action="field101Action"
	            :headers="token"
	            :on-success="handleAvatarSuccess"
	            :on-remove="removeFile"
	            :auto-upload="autoUploadFalg"
	            multiple
	            :limit="20"
	            :before-upload="field101BeforeUpload"
	          >
	            <el-button slot="trigger" size="small" type="primary"
	              >选取文件</el-button
	            >
	          </el-upload>
	        </el-form-item> -->



	      </el-form>
         </el-row>
  <el-row :gutter="15">
    <el-col :span="24" >
      <el-divider content-position="center" ><el-link type="primary"><b>审核信息</b></el-link></el-divider>
    </el-col>
  </el-row>

  <el-row :gutter="15">
    <el-table :data="tableData">
      <el-table-column label="任务节点" prop="taskNodeName" header-align="center" align="center">
      </el-table-column>
      <el-table-column label="审批人" prop="createName" header-align="center" align="center">
      </el-table-column>
      <el-table-column label="审批意见" prop="controlValue" header-align="center" align="center">
      </el-table-column>
      <el-table-column label="审批时间" prop="createTime"   header-align="center" align="center">
      </el-table-column>
    </el-table>
  </el-row>
</el-dialog>
</div>
</template>

<script>
  import { getLeave } from '@/api/workflow/leave'
  import { getNgcAudit ,historyFromData,getCollectionAudit } from '@/api/activiti/historyFormdata'
  export default {
    name: "leaveHistoryForm",
    props: {
      businessKey: {
        type: String
      }
    },
    data(){
      return{
        modalShow:false,
        tableData:[],
        show:false,
        // 表单参数
        form: {},
        invoiceDataList:[], //开票信息
        fromData:[],
      }
    },
    created() {
      // this.getLeave()
      // this.historyFromData()
    },
    methods:{
       init(row) {
          this.tableData=[];
        getNgcAudit(row.businessKey).then(response => {
           this.modalShow = true;
          this.form = response.data
          let proName_ = response.data;
           this.tableData = response.data.actWorkflowFormDatas;
         this.getDicts("project_sort").then((response) => {
           for(let item of response.data) {
             if(item.dictValue==proName_.classification){
               this.form.classification = item.dictLabel;
             }
           }
         });
         this.getDicts("project_sort").then(response1 => {
           for(let item of response1.data) {
             if(item.dictSort==this.form.classification){
               this.form.classification = item.dictLabel;
             }
           }
         });



        })
      },
      modalClose(){
          this.modalShow = false;
      },
      historyFromData() {
        historyFromData(this.businessKey).then(response => {
          this.fromData = response.data
        })
      },
    }

  }
</script>

<style scoped lang="scss">
  .input-noborder ::v-deep {
    .el-input__inner {
      border: 0;
      background-color: #f8f8f9;
    }
  }
  .el-alert  ::v-deep {
    .el-alert__content {
      width: 100%;
    }
  }
  .box-card {
    width: 50%;
  }
  .in-text {
    display:inline-block;width: 50%;
    font-size: 14px;
  }

  .clearfix:before,
  .clearfix:after {
    display: table;
    content: "";
  }
  .clearfix:after {
    clear: both
  }

</style>
