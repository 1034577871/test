<template>
  <div>
    <el-form ref="elForm" :model="formData" size="medium" label-width="100px">
      <table class="curr-table ">
        <tbody>
          <tr>
            <th width="10%">序号</th>
            <th width="10%">施工项目</th>
            <th width="25%">内容说明</th>
            <th width="10%">单位</th>
            <th width="10%">所需工日</th>
            <th width="10%">工日单价</th>
            <th width="15%">金额</th>
            <th width="5%">
              操作
            </th>
            <th>
              <el-button
                size="mini"
                type="success"
                @click="loadMore()"
                style="margin: 10px;"
                >新增</el-button
              >
            </th>
          </tr>
          <tr v-for="(value, index) in dataList" :key="index">
            <td>
              {{ index+1 }}
            </td>
            <td>
              <el-input
                v-model="value.projectName"
                :name="'appMateList[' + index + '].projectName'"
              />
            </td>
            <td>
              <el-input
                v-model="value.description"
                :name="'appMateList[' + index + '].description'"
              />
            </td>
            <td>
              <el-input
                v-model="value.projectUnit"
                :name="'appMateList[' + index + '].projectUnit'"
              />
            </td>
            <td>
              <el-input
                v-model="value.days"
                :name="'appMateList[' + index + '].days'"
                v-on:input="changeNum(index)"
              />
            </td>
            <td>
              <el-input
                v-model="value.daysPrice"
                :name="'appMateList[' + index + '].daysPrice'"
                v-on:input="changeNum(index)"
              />
            </td>
            <td>
              <el-input
              :disabled="true"
                v-model="value.daysAmount"
                :name="'appMateList[' + index + '].daysAmount'"
              />
            </td>
            <td>
              <el-button
                size="mini"
                type="warning"
                @click.prevent="removeTodo(index)"
                >删除</el-button
              >
            </td>
            <td>
              <el-input
                type="hidden"
                v-model="value.id"
                :name="'appMateList[' + index + '].id'"
              />
            </td>
          </tr>
        </tbody>
      </table>
    </el-form>

    <!-- <el-row :gutter="15">
      <el-form
        ref="elForm"
        :model="formData"
        :rules="rules"
        size="medium"
        label-width="120px"
      >
        <el-col :span="24">
          <el-form-item label="施工项目">
            <el-input v-model="formData.projectName"></el-input>
          </el-form-item>
        </el-col>
        <el-col :span="24">
          <el-form-item label="内容说明">
            <el-input v-model="formData.description"></el-input>
          </el-form-item>
        </el-col>
        <el-col :span="12">
          <el-form-item label="单位">
            <el-input v-model="formData.projectUnit"></el-input>
          </el-form-item>
        </el-col>
        <el-col :span="12">
          <el-form-item label="所需工日">
            <el-input
              v-model="formData.days"
              v-on:input="changeNum()"
            ></el-input>
          </el-form-item>
        </el-col>
        <el-col :span="12">
          <el-form-item label="工日单价">
            <el-input
              v-model="formData.daysPrice"
              v-on:input="changeNum()"
            ></el-input>
          </el-form-item>
        </el-col>
        <el-col :span="12">
          <el-form-item label="金额">
            <el-input v-model="formData.daysAmount" :disabled="true"></el-input>
          </el-form-item>
        </el-col>
      </el-form>
    </el-row> -->
  </div>
</template>
<script>
export default {
  components: {},
  props: {
    construcostInfoDate: {}
  },
  data() {
    return {
      formData: null,
      dataList: this.construcostInfoDate
    };
  },
  created() {
    this.dataList = [];
    if (!this.construcostInfoDate) {
      this.dataList.push({
        id: null,
        projectName: null,
        description: null,
        projectUnit: null,
        days: null,
        daysPrice: null,
        daysAmount: null
      });
    }
  },
  methods: {
    /** 添加行 **/
    loadMore: function() {
      this.dataList.push({
        id: null,
        projectName: null,
        description: null,
        projectUnit: null,
        days: null,
        daysPrice: null,
        daysAmount: null
      });
    },
    /** 删除行 **/
    removeTodo: function(index) {
      this.dataList.splice(index, 1);
    },
    /** 计算金额,格式化信息 **/
    changeNum(indexNum) {
      let days = this.dataList[indexNum].days;
      let daysPrice = this.dataList[indexNum].daysPrice;
      if (days && daysPrice) {
        this.dataList[indexNum].daysAmount = this.formatPrice(
          days * daysPrice
        );
      }
    },
    /** 格式化金额 **/
    formatPrice(value) {
      let tempVal = parseFloat(value).toFixed(3);
      let realVal = tempVal.substring(0, tempVal.length - 1);
      return realVal;
    }
  }
};
</script>

<style scoped  lang="scss">
.curr-table {
  text-align: center;
  width: 100%;
  vertical-align: middle;
  border-spacing: 0px;
  border-style: none;
  border-collapse: collapse;
}
.curr-table td,th {
  padding: 5px 10px;
}
.curr-table th {
  font-weight: bold;
  background-color: #eff3fa;
  height: 40px;
}

</style>
