<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.collection.mapper.CtBuInvoiceInfoMapper">
    
    <resultMap type="CtBuInvoiceInfo" id="CtBuInvoiceInfoResult">
        <result property="id"    column="id"    />
        <result property="contractCategory"    column="contract_category"    />
        <result property="reqId"    column="req_id"    />
        <result property="invoiceCode"    column="invoice_code"    />
        <result property="invoiceNo"    column="invoice_no"    />
        <result property="invoiceDate"    column="invoice_date"    />
        <result property="invoiceDrawer"    column="invoice_drawer"    />
        <result property="invoiceReviewer"    column="invoice_reviewer"    />
        <result property="invoicePayee"    column="invoice_payee"    />
        <result property="invoiceAmountTax"    column="invoice_amount_tax"    />
        <result property="invoiceTaxrate"    column="invoice_taxrate"    />
        <result property="invoiceAmountNtax"    column="invoice_amount_ntax"    />
        <result property="invoiceImg"    column="invoice_img"    />
        <result property="companyImg"    column="company_img"    />
        <result property="handoverUserid"    column="handover_userid"    />
        <result property="handoverUsername"    column="handover_username"    />
        <result property="handoverTime"    column="handover_time"    />
        <result property="confirmerUserid"    column="confirmer_userid"    />
        <result property="confirmerUsername"    column="confirmer_username"    />
        <result property="confirmerTime"    column="confirmer_time"    />
        <result property="voucherNo"    column="voucher_no"    />
        <result property="voucherUserid"    column="voucher_userid"    />
        <result property="voucherUsername"    column="voucher_username"    />
        <result property="voucherTime"    column="voucher_time"    />
        <result property="status"    column="status"    />
        <result property="statusps"    column="statusPS"    />
        <result property="delFlag"    column="del_flag"    />
        <result property="remark"    column="remark"    />
        <result property="createBy"    column="create_by"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateBy"    column="update_by"    />
        <result property="updateTime"    column="update_time"    />
    </resultMap>

    <sql id="selectCtBuInvoiceInfoVo">
        select id, contract_category, req_id, invoice_code, invoice_no, invoice_date, invoice_drawer, invoice_reviewer, invoice_payee, invoice_amount_tax, invoice_taxrate, invoice_amount_ntax, invoice_img, company_img, handover_userid, handover_username, handover_time, confirmer_userid, confirmer_username, confirmer_time, voucher_no, voucher_userid, voucher_username, voucher_time, status, statusPS, del_flag, remark, create_by, create_time, update_by, update_time from ct_bu_invoice_info
    </sql>

    <select id="selectCtBuInvoiceInfoList" parameterType="CtBuInvoiceInfo" resultMap="CtBuInvoiceInfoResult">
        <include refid="selectCtBuInvoiceInfoVo"/>
        <where>
            del_flag = 1
            <if test="contractCategory != null  and contractCategory != ''"> and contract_category = #{contractCategory}</if>
            <if test="reqId != null  and reqId != ''"> and req_id = #{reqId}</if>
            <if test="invoiceCode != null  and invoiceCode != ''"> and invoice_code = #{invoiceCode}</if>
            <if test="invoiceNo != null  and invoiceNo != ''"> and invoice_no = #{invoiceNo}</if>
            <if test="invoiceDate != null "> and invoice_date = #{invoiceDate}</if>
            <if test="invoiceDrawer != null  and invoiceDrawer != ''"> and invoice_drawer = #{invoiceDrawer}</if>
            <if test="invoiceReviewer != null  and invoiceReviewer != ''"> and invoice_reviewer = #{invoiceReviewer}</if>
            <if test="invoicePayee != null  and invoicePayee != ''"> and invoice_payee = #{invoicePayee}</if>
            <if test="invoiceAmountTax != null "> and invoice_amount_tax = #{invoiceAmountTax}</if>
            <if test="invoiceTaxrate != null  and invoiceTaxrate != ''"> and invoice_taxrate = #{invoiceTaxrate}</if>
            <if test="invoiceAmountNtax != null "> and invoice_amount_ntax = #{invoiceAmountNtax}</if>
            <if test="invoiceImg != null "> and invoice_img = #{invoiceImg}</if>
            <if test="companyImg != null "> and company_img = #{companyImg}</if>
            <if test="handoverUserid != null  and handoverUserid != ''"> and handover_userid = #{handoverUserid}</if>
            <if test="handoverUsername != null  and handoverUsername != ''"> and handover_username like concat('%', #{handoverUsername}, '%')</if>
            <if test="handoverTime != null "> and handover_time = #{handoverTime}</if>
            <if test="confirmerUserid != null  and confirmerUserid != ''"> and confirmer_userid = #{confirmerUserid}</if>
            <if test="confirmerUsername != null  and confirmerUsername != ''"> and confirmer_username like concat('%', #{confirmerUsername}, '%')</if>
            <if test="confirmerTime != null "> and confirmer_time = #{confirmerTime}</if>
            <if test="voucherNo != null  and voucherNo != ''"> and voucher_no = #{voucherNo}</if>
            <if test="voucherUserid != null  and voucherUserid != ''"> and voucher_userid = #{voucherUserid}</if>
            <if test="voucherUsername != null  and voucherUsername != ''"> and voucher_username like concat('%', #{voucherUsername}, '%')</if>
            <if test="voucherTime != null "> and voucher_time = #{voucherTime}</if>
            <if test="status != null "> and status status &gt;= #{status} #{status}</if>
            <if test="statusps != null  and statusps != ''"> and statusPS = #{statusps}</if>
        </where>
    </select>
    
    <select id="selectCtBuInvoiceInfoById" parameterType="String" resultMap="CtBuInvoiceInfoResult">
        <include refid="selectCtBuInvoiceInfoVo"/>
        where id = #{id} and del_flag = 1
    </select>
        
    <insert id="insertCtBuInvoiceInfo" parameterType="CtBuInvoiceInfo">
        insert into ct_bu_invoice_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">id,</if>
            <if test="contractCategory != null">contract_category,</if>
            <if test="reqId != null">req_id,</if>
            <if test="invoiceCode != null">invoice_code,</if>
            <if test="invoiceNo != null">invoice_no,</if>
            <if test="invoiceDate != null">invoice_date,</if>
            <if test="invoiceDrawer != null">invoice_drawer,</if>
            <if test="invoiceReviewer != null">invoice_reviewer,</if>
            <if test="invoicePayee != null">invoice_payee,</if>
            <if test="invoiceAmountTax != null">invoice_amount_tax,</if>
            <if test="invoiceTaxrate != null">invoice_taxrate,</if>
            <if test="invoiceAmountNtax != null">invoice_amount_ntax,</if>
            <if test="invoiceImg != null">invoice_img,</if>
            <if test="companyImg != null">company_img,</if>
            <if test="handoverUserid != null">handover_userid,</if>
            <if test="handoverUsername != null">handover_username,</if>
            <if test="handoverTime != null">handover_time,</if>
            <if test="confirmerUserid != null">confirmer_userid,</if>
            <if test="confirmerUsername != null">confirmer_username,</if>
            <if test="confirmerTime != null">confirmer_time,</if>
            <if test="voucherNo != null">voucher_no,</if>
            <if test="voucherUserid != null">voucher_userid,</if>
            <if test="voucherUsername != null">voucher_username,</if>
            <if test="voucherTime != null">voucher_time,</if>
            <if test="status != null">status,</if>
            <if test="statusps != null">statusPS,</if>
            <if test="delFlag != null">del_flag,</if>
            <if test="remark != null">remark,</if>
            <if test="createBy != null">create_by,</if>
            <if test="createTime != null">create_time,</if>
            <if test="updateBy != null">update_by,</if>
            <if test="updateTime != null">update_time,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">#{id},</if>
            <if test="contractCategory != null">#{contractCategory},</if>
            <if test="reqId != null">#{reqId},</if>
            <if test="invoiceCode != null">#{invoiceCode},</if>
            <if test="invoiceNo != null">#{invoiceNo},</if>
            <if test="invoiceDate != null">#{invoiceDate},</if>
            <if test="invoiceDrawer != null">#{invoiceDrawer},</if>
            <if test="invoiceReviewer != null">#{invoiceReviewer},</if>
            <if test="invoicePayee != null">#{invoicePayee},</if>
            <if test="invoiceAmountTax != null">#{invoiceAmountTax},</if>
            <if test="invoiceTaxrate != null">#{invoiceTaxrate},</if>
            <if test="invoiceAmountNtax != null">#{invoiceAmountNtax},</if>
            <if test="invoiceImg != null">#{invoiceImg},</if>
            <if test="companyImg != null">#{companyImg},</if>
            <if test="handoverUserid != null">#{handoverUserid},</if>
            <if test="handoverUsername != null">#{handoverUsername},</if>
            <if test="handoverTime != null">#{handoverTime},</if>
            <if test="confirmerUserid != null">#{confirmerUserid},</if>
            <if test="confirmerUsername != null">#{confirmerUsername},</if>
            <if test="confirmerTime != null">#{confirmerTime},</if>
            <if test="voucherNo != null">#{voucherNo},</if>
            <if test="voucherUserid != null">#{voucherUserid},</if>
            <if test="voucherUsername != null">#{voucherUsername},</if>
            <if test="voucherTime != null">#{voucherTime},</if>
            <if test="status != null">#{status},</if>
            <if test="statusps != null">#{statusps},</if>
            <if test="delFlag != null">#{delFlag},</if>
            <if test="remark != null">#{remark},</if>
            <if test="createBy != null">#{createBy},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="updateBy != null">#{updateBy},</if>
            <if test="updateTime != null">#{updateTime},</if>
         </trim>
    </insert>

    <update id="updateCtBuInvoiceInfo" parameterType="CtBuInvoiceInfo">
        update ct_bu_invoice_info
        <trim prefix="SET" suffixOverrides=",">
            <if test="contractCategory != null">contract_category = #{contractCategory},</if>
            <if test="reqId != null">req_id = #{reqId},</if>
            <if test="invoiceCode != null">invoice_code = #{invoiceCode},</if>
            <if test="invoiceNo != null">invoice_no = #{invoiceNo},</if>
            <if test="invoiceDate != null">invoice_date = #{invoiceDate},</if>
            <if test="invoiceDrawer != null">invoice_drawer = #{invoiceDrawer},</if>
            <if test="invoiceReviewer != null">invoice_reviewer = #{invoiceReviewer},</if>
            <if test="invoicePayee != null">invoice_payee = #{invoicePayee},</if>
            <if test="invoiceAmountTax != null">invoice_amount_tax = #{invoiceAmountTax},</if>
            <if test="invoiceTaxrate != null">invoice_taxrate = #{invoiceTaxrate},</if>
            <if test="invoiceAmountNtax != null">invoice_amount_ntax = #{invoiceAmountNtax},</if>
            <if test="invoiceImg != null">invoice_img = #{invoiceImg},</if>
            <if test="companyImg != null">company_img = #{companyImg},</if>
            <if test="handoverUserid != null">handover_userid = #{handoverUserid},</if>
            <if test="handoverUsername != null">handover_username = #{handoverUsername},</if>
            <if test="handoverTime != null">handover_time = #{handoverTime},</if>
            <if test="confirmerUserid != null">confirmer_userid = #{confirmerUserid},</if>
            <if test="confirmerUsername != null">confirmer_username = #{confirmerUsername},</if>
            <if test="confirmerTime != null">confirmer_time = #{confirmerTime},</if>
            <if test="voucherNo != null">voucher_no = #{voucherNo},</if>
            <if test="voucherUserid != null">voucher_userid = #{voucherUserid},</if>
            <if test="voucherUsername != null">voucher_username = #{voucherUsername},</if>
            <if test="voucherTime != null">voucher_time = #{voucherTime},</if>
            <if test="status != null">status = #{status},</if>
            <if test="statusps != null">statusPS = #{statusps},</if>
            <if test="delFlag != null">del_flag = #{delFlag},</if>
            <if test="remark != null">remark = #{remark},</if>
            <if test="createBy != null">create_by = #{createBy},</if>
            <if test="createTime != null">create_time = #{createTime},</if>
            <if test="updateBy != null">update_by = #{updateBy},</if>
            <if test="updateTime != null">update_time = #{updateTime},</if>
        </trim>
        where id = #{id}
    </update>

<!--    <delete id="deleteCtBuInvoiceInfoById" parameterType="String">-->
<!--        delete from ct_bu_invoice_info where id = #{id}-->
<!--    </delete>-->

<!--    <delete id="deleteCtBuInvoiceInfoByIds" parameterType="String">-->
<!--        delete from ct_bu_invoice_info where id in -->
<!--        <foreach item="id" collection="array" open="(" separator="," close=")">-->
<!--            #{id}-->
<!--        </foreach>-->
<!--    </delete>-->


    <update id="deleteCtBuInvoiceInfoById" parameterType="String">
        update ct_bu_invoice_info set del_flag = 2  where id = #{id}
    </update>

    <update id="deleteCtBuInvoiceInfoByIds" parameterType="String">
        update ct_bu_invoice_info set del_flag = 2 where id in
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </update>

    <!-- 移交发票 -->
    <update id="updateCtBuInvoiceInfoByIds" parameterType="Map">
        update ct_bu_invoice_info
        <trim prefix="SET" suffixOverrides=",">
            <if test="handoverUserid != null and handoverUserid!=''">handover_userid = #{handoverUserid},</if>
            <if test="handoverUsername != null and handoverUsername!=''"> handover_username = #{handoverUsername},</if>
            <if test="handoverTime != null ">handover_time = #{handoverTime},</if>
            <if test="confirmerUserid != null and confirmerUserid!=''">confirmer_userid = #{confirmerUserid},</if>
            <if test="voucherUsername != null and voucherUsername!=''">voucher_username = #{voucherUsername},</if>
            <if test="confirmerTime != null ">confirmer_time = #{confirmerTime},</if>

            <if test="voucherNo != null and voucherNo!=''">voucher_no = #{voucherNo},</if>
            <if test="voucherUserid != null and voucherUserid!=''">voucher_userid = #{voucherUserid},</if>
            <if test="voucherUsername != null and voucherUsername!=''">voucher_username = #{voucherUsername},</if>
            <if test="voucherTime != null ">voucher_time = #{voucherTime},</if>
            <if test="status != null and status!=''">status = #{status},</if>

        </trim>
         where id in
        <foreach item="id" collection="ids" open="(" separator="," close=")">
            #{id}
        </foreach>
    </update>
    
</mapper>